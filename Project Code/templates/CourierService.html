<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>GoParcel | Admin Portal</title>

    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='cyan'%3E%3Cpath d='M7 2v11h3v9l7-12h-4l4-8z'/%3E%3C/svg%3E">

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Poppins:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='Styles.css') }}"
    />
</head>
  <body>
    <div class="background-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>

    <section id="login-section" class="active-section">
      <div class="login-card glass">
        <div class="login-header">
          <div class="icon-circle"><i class="fas fa-cube"></i></div>
          <h2>Welcome Back</h2>
          <p>Enter your admin credentials</p>
        </div>
        <form id="loginForm">
          <div class="input-group">
            <input type="email" id="username" required autocomplete="off" />
            <label>Email Address</label>
            <i class="fas fa-envelope"></i>
          </div>
          <div class="input-group">
            <input type="password" id="password" required />
            <label>Password</label>
            <i class="fas fa-eye" id="togglePassword"></i>
          </div>
          <button type="submit" class="btn-primary">
            <span>Login Securely</span> <i class="fas fa-arrow-right"></i>
          </button>
        </form>
        <p id="login-error" class="error-msg"></p>
      </div>
    </section>

    <div id="main-app" class="hidden">
      <aside class="sidebar glass">
        <div class="brand">
          <i class="fas fa-bolt"></i> <span>GoParcel</span>
        </div>
        <div class="menu">
          <p class="menu-label">Main</p>
          <ul>
            <li onclick="showSection('dashboard')" class="active-nav">
              <i class="fas fa-th-large"></i> <span>Dashboard</span>
            </li>
            <li onclick="showSection('add-shipment')" id="nav-add">
              <i class="fas fa-box-open"></i> <span>New Shipment</span>
            </li>
            <li onclick="showSection('view-shipment')">
              <i class="fas fa-table"></i> <span>Manage All</span>
            </li>
            <li onclick="showSection('tracking')">
              <i class="fas fa-map-marked-alt"></i> <span>Live Tracking</span>
            </li>
          </ul>
          <p class="menu-label">Actions</p>
          <ul>
            <li onclick="showSection('print-section')">
              <i class="fas fa-print"></i> <span>Print Invoice</span>
            </li>
          </ul>
          <p class="menu-label">System</p>
          <ul>
            <!-- Profile Option Removed from Sidebar -->
            <li onclick="logout()" class="logout-item">
              <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
            </li>
          </ul>
        </div>
      </aside>

      <main class="content-area">
        <header class="top-bar glass">
          <h2 id="page-title">Dashboard</h2>
          <div class="user-info">
            <span>Admin</span>
          </div>
        </header>

        <div class="scrollable-content">
          <section id="dashboard" class="app-section">
            <div class="scroll-container">
              <div class="dashboard-profile-card glass">
                <div class="profile-icon-large">
                  <i class="fas fa-user-tie"></i>
                </div>
                <div class="profile-details">
                  <h2>System Administrator</h2>
                  <p class="email-text">admin.17193@gmail.com</p>
                  <span class="badge-admin">Super Admin</span>
                </div>
              </div>

              <div class="stats-container">
                <div class="stat-card glass gradient-1">
                  <div class="stat-icon"><i class="fas fa-box"></i></div>
                  <div class="stat-info">
                    <h3>Total Shipments</h3>
                    <h1 id="stat-total">0</h1>
                  </div>
                </div>
                <div class="stat-card glass gradient-2">
                  <div class="stat-icon">
                    <i class="fas fa-shipping-fast"></i>
                  </div>
                  <div class="stat-info">
                    <h3>In Transit</h3>
                    <h1 id="stat-transit">0</h1>
                  </div>
                </div>
                <div class="stat-card glass gradient-3">
                  <div class="stat-icon">
                    <i class="fas fa-check-circle"></i>
                  </div>
                  <div class="stat-info">
                    <h3>Delivered</h3>
                    <h1 id="stat-delivered">0</h1>
                  </div>
                </div>
              </div>

              <div class="terms-section glass">
                <h3 class="terms-title">
                  <i class="fas fa-file-contract"></i> Service Conditions &
                  Guidelines
                </h3>
                <ul class="terms-list">
                  <li>
                    Proper and secure packaging must be done by the sender
                    before shipment.
                  </li>
                  <li>
                    Fragile, liquid, or sensitive items must be clearly labeled
                    and packed safely.
                  </li>
                  <li>
                    Delivery time may vary based on distance, weather, or
                    service availability.
                  </li>
                  <li>
                    Tracking details are provided only after the shipment is
                    booked.
                  </li>
                  <li>
                    Restricted or prohibited items (like explosives or illegal
                    goods) are not allowed.
                  </li>
                  <li>
                    Additional charges apply for overweight, oversized, or
                    special-handling parcels.
                  </li>
                  <li>
                    Insurance is recommended for high-value shipments, and
                    liability is limited.
                  </li>
                  <li>
                    Accurate sender and receiver details must be provided to
                    avoid delays.
                  </li>
                  <li>
                    Delivery attempts are limited, and failed deliveries may
                    require rebooking charges.
                  </li>
                  <li>
                    Valid ID or signature may be required at the time of
                    delivery or pickup.
                  </li>
                </ul>
              </div>
            </div>
          </section>
          <section id="add-shipment" class="app-section hidden">
            <div class="form-container glass scroll-container">
              <form id="shipmentForm">
                <input type="hidden" name="shipment_id" id="edit_id" />

                <div class="form-section">
                  <h3><i class="fas fa-paper-plane"></i> Sender Details</h3>
                  <div class="row-2-col">
                    <input
                      type="text"
                      name="s_name"
                      id="s_name"
                      placeholder="Sender Name"
                      required
                    />
                    <input
                      type="text"
                      name="s_phone"
                      id="s_phone"
                      placeholder="Phone (10 digits)"
                      required
                    />
                  </div>
                  <div class="row-2-col">
                    <input
                      type="text"
                      name="s_addr"
                      id="s_addr"
                      placeholder="Address"
                      required
                    />
                    <input
                      type="text"
                      name="s_city"
                      id="s_city"
                      placeholder="City"
                      required
                    />
                  </div>
                </div>

                <div class="form-section">
                  <h3>
                    <i class="fas fa-map-marker-alt"></i> Receiver Details
                  </h3>
                  <div class="row-2-col">
                    <input
                      type="text"
                      name="r_name"
                      id="r_name"
                      placeholder="Receiver Name"
                      required
                    />
                    <input
                      type="text"
                      name="r_phone"
                      id="r_phone"
                      placeholder="Phone (10 digits)"
                      required
                    />
                  </div>
                  <div class="row-2-col">
                    <input
                      type="text"
                      name="r_addr"
                      id="r_addr"
                      placeholder="Address"
                      required
                    />
                    <input
                      type="text"
                      name="r_city"
                      id="r_city"
                      placeholder="City"
                      required
                    />
                  </div>
                </div>

                <div class="form-section">
                  <h3><i class="fas fa-calculator"></i> Shipment Costs</h3>
                  <textarea
                    name="c_desc"
                    id="c_desc"
                    placeholder="Package Description / Notes"
                    rows="2"
                    style="margin-bottom: 15px"
                  ></textarea>

                  <div class="row-3-col-flex">
                    <input
                      type="number"
                      id="weight"
                      name="c_weight"
                      placeholder="Weight (Kg)"
                      step="0.1"
                      required
                    />
                    <input
                      type="number"
                      id="distance"
                      name="c_dist"
                      placeholder="Distance (Km)"
                      step="0.1"
                      required
                    />
                    <div class="total-display-mini">
                      <span>Total: â‚¹</span>
                      <input
                        type="number"
                        name="c_amount"
                        id="totalAmount"
                        readonly
                      />
                    </div>
                  </div>
                </div>

                <div class="form-actions">
                  <button type="submit" id="submitBtn" class="btn-primary">
                    Save Shipment
                  </button>
                  <button
                    type="button"
                    onclick="resetForm()"
                    class="btn-secondary"
                  >
                    Reset
                  </button>
                  <button
                    type="button"
                    onclick="showSection('dashboard')"
                    class="btn-danger"
                  >
                    Back
                  </button>
                </div>
              </form>
            </div>
          </section>

          <section id="view-shipment" class="app-section hidden">
            <div class="table-wrapper glass">
              <div class="table-tools">
                <input
                  type="text"
                  id="searchBar"
                  placeholder="Search by MB ID or Name..."
                  onkeyup="searchTable()"
                />
              </div>
              <div class="table-scroll-area">
                <table id="shipmentTable">
                  <thead>
                    <tr>
                      <th>S.No.</th>
                      <th>Shipment ID</th>
                      <th>Sender</th>
                      <th>Receiver</th>
                      <th>Status</th>
                      <th>Total (INR)</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </section>

          <section id="tracking" class="app-section hidden">
            <div class="tracking-container glass">
              <div class="track-input-group">
                <input
                  type="text"
                  id="trackInput"
                  placeholder="Enter ID (e.g. MB_17193001)"
                />
                <button onclick="realTimeTracking()" class="btn-primary">
                  Track
                </button>
                <button
                  onclick="resetTracking()"
                  class="btn-secondary btn-reset"
                >
                  Reset
                </button>
              </div>

              <div id="tracking-loader" class="hidden">
                <div class="scanner"></div>
                <p>Searching Network...</p>
              </div>

              <div id="tracking-ui" class="hidden">
                <h3
                  id="track-id-display"
                  style="margin-bottom: 20px; color: var(--primary)"
                ></h3>
                <div class="timeline">
                  <div class="timeline-item" id="step-Booked">
                    <div class="dot"><i class="fas fa-box"></i></div>
                    <div class="content">Booked</div>
                  </div>
                  <div class="timeline-item" id="step-Transit">
                    <div class="dot"><i class="fas fa-shipping-fast"></i></div>
                    <div class="content">In Transit</div>
                  </div>
                  <div class="timeline-item" id="step-Out">
                    <div class="dot"><i class="fas fa-truck"></i></div>
                    <div class="content">Out for Delivery</div>
                  </div>
                  <div class="timeline-item" id="step-Delivered">
                    <div class="dot"><i class="fas fa-check"></i></div>
                    <div class="content">Delivered</div>
                  </div>
                </div>

                <div
                  id="track-details-box"
                  class="glass"
                  style="margin-top: 30px; padding: 20px; text-align: left"
                >
                  <p><strong>From:</strong> <span id="track-from"></span></p>
                  <p><strong>To:</strong> <span id="track-to"></span></p>
                  <p>
                    <strong>Current Status:</strong>
                    <span id="track-status" style="color: var(--accent)"></span>
                  </p>
                </div>
              </div>
            </div>
          </section>

          <section id="print-section" class="app-section hidden">
            <div
              class="glass"
              style="
                padding: 20px;
                text-align: center;
                height: 100%;
                display: flex;
                flex-direction: column;
              "
            >
              <h3 style="margin-bottom: 20px; color: white">
                Generate Invoice
              </h3>

              <div
                class="track-input-group"
                style="max-width: 600px; margin: 0 auto 20px auto"
              >
                <input
                  type="text"
                  id="printInputId"
                  placeholder="Enter ID (e.g. MB_17193001)"
                />
                <button onclick="fetchInvoiceDetails()" class="btn-primary">
                  Fetch
                </button>
                <button
                  onclick="resetInvoice()"
                  class="btn-secondary btn-reset"
                >
                  Reset
                </button>
              </div>

              <div
                class="invoice-scroll-wrapper"
                style="flex: 1; overflow-y: auto; padding: 10px"
              >
                <div id="invoice-preview" class="hidden"></div>
              </div>

              <div id="print-actions" class="hidden" style="margin-top: 20px">
                <button
                  onclick="printInvoiceNow()"
                  class="btn-primary"
                  style="width: 200px; background: var(--success)"
                >
                  <i class="fas fa-print"></i> Print Bill
                </button>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>
    <div id="toast-container"></div>
    <script src="{{ url_for('static', filename='Script.js') }}"></script>
  </body>
</html>
